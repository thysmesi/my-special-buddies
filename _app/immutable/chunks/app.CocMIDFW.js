var u=Object.defineProperty;var m=(c,e,i)=>e in c?u(c,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[e]=i;var h=(c,e,i)=>(m(c,typeof e!="symbol"?e+"":e,i),i);class b{constructor({email:e=null,password:i=null,name:t=null,childName:a=null,bio:r=null,location:s=null,favoriteActivities:n=null,token:d=null}){this.email=e,this.password=i,this.name=t,this.childName=a,this.bio=r,this.location=s,this.favoriteActivities=n,this.token=d}get editableJson(){return JSON.stringify({name:this.name,child_name:this.childName,bio:this.bio,location:this.location,favorite_activities:this.favoriteActivities})}get authJson(){return JSON.stringify({email:this.email,password:this.password})}get json(){return JSON.stringify({email:this.email,password:this.password,name:this.name,child_name:this.childName,bio:this.bio,location:this.location,favorite_activities:this.favoriteActivities})}}const o=class o{static deleteCookie(e){this.getCookie(e)&&(document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT")}static getCookie(e){let i=e+"=",a=decodeURIComponent(document.cookie).split(";");for(let r=0;r<a.length;r++){let s=a[r];for(;s.charAt(0)==" ";)s=s.substring(1);if(s.indexOf(i)==0)return s.substring(i.length,s.length)}return!1}static setCookie(e,i,t){const a=new Date;a.setTime(a.getTime()+t*24*60*60*1e3);let r="expires="+a.toUTCString();document.cookie=e+"="+i+";"+r+";path=/"}static async post(e,i){var t;return new Promise((a,r)=>{fetch(e,{method:"POST",body:i,headers:{"Content-type":"application/json; charset=UTF-8"}}).then(s=>(t=s,s.json())).then(s=>a({body:s,response:t})).catch(s=>{r(s)})})}static async patch(e,i,t){var a;return new Promise((r,s)=>{fetch(e,{method:"PATCH",body:i,headers:{Authorization:`Bearer ${t}`,"Content-type":"application/json; charset=UTF-8"}}).then(n=>(a=n,n.json())).then(n=>r({body:n,response:a})).catch(n=>{s(n)})})}static async delete(e,i){var t;return new Promise((a,r)=>{fetch(e,{method:"DELETE",headers:{Authorization:`Bearer ${i}`,"Content-type":"application/json; charset=UTF-8"}}).then(s=>(t=s,s.json())).then(s=>a({body:s,response:t})).catch(s=>{r(s)})})}static logout(){this.deleteCookie(o.tokenCookieName)}static async login(e,i){try{let{body:t,response:a}=await this.post(o.baseUrl+o.loginPath,e.authJson);if(!a.ok)throw"Unable to authenticate user";i&&this.setCookie(o.tokenCookieName,t.token,o.rememberMeDuration),console.log(t),this.user=new b({email:t.user.email,password:t.user.password,childName:t.user.child_name,bio:t.user.bio,location:t.user.location,name:t.user.name,favoriteActivities:t.user.favorite_activities,token:t.token})}catch(t){throw t}}static async signUp(e){try{let{body:i,response:t}=await this.post(o.baseUrl+o.signUpPath,e.json);if(console.log(t),!t.ok)throw"Unable to create account"}catch(i){throw i}}static async updateUser(e){let i=this.user.token;if(i==null)throw"Permission denied";try{let{body:t,response:a}=await this.patch(o.baseUrl+o.editUserPath,e.editableJson,i);if(this.user.childName=t.child_name,this.user.bio=t.bio,this.user.location=t.location,this.user.name=t.name,this.user.favoriteActivities=t.favorite_activities,!a.ok)throw"Unable to save changes"}catch(t){throw t}}static async deleteUser(){let e=this.user.token;if(e==null)throw"Permission denied";try{let{response:i}=await this.delete(o.baseUrl+o.editUserPath,e);if(!i.ok)throw"Unable to delete profile"}catch(i){throw i}}};h(o,"baseUrl","https://myspecialbuddies.onrender.com"),h(o,"signUpPath","/signup/user"),h(o,"loginPath","/login/user"),h(o,"editUserPath","/user"),h(o,"rememberMeDuration",30),h(o,"tokenCookieName","jwt_token"),h(o,"user",null);let l=o;export{l as A,b as U};
